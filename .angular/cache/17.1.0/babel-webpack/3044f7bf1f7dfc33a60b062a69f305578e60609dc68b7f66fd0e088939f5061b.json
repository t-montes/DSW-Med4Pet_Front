{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { Agenda } from 'src/app/agenda/agenda';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"../veterinario.service\";\nimport * as i4 from \"src/app/servicio/servicio.service\";\nimport * as i5 from \"src/app/agenda/agenda.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"../../contacto/contacto-create/contacto-create.component\";\nimport * as i8 from \"../../registroMedico/registroMedico-create/registroMedico-create.component\";\nimport * as i9 from \"@angular/common\";\nfunction VeterinarioCreateComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"app-registroMedico-create\", 23);\n    i0.ɵɵlistener(\"newItemEvent\", function VeterinarioCreateComponent_div_0_Template_app_registroMedico_create_newItemEvent_1_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.addRegistro($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction VeterinarioCreateComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"app-contacto-create\", 23);\n    i0.ɵɵlistener(\"newItemEvent\", function VeterinarioCreateComponent_div_1_Template_app_contacto_create_newItemEvent_1_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.addContacto($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction VeterinarioCreateComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Nombre Requerido \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VeterinarioCreateComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Nombre muy corto, debe ser de almenos 2 caracteres \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VeterinarioCreateComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Especialidad requerida \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VeterinarioCreateComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Certificado de Entrenamiento requerido \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VeterinarioCreateComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Experiencia Previa Requerida \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VeterinarioCreateComponent_tr_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const s_r13 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(s_r13.nombre);\n  }\n}\nfunction VeterinarioCreateComponent_div_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Servicios Ofrecidos Requeridos \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let VeterinarioCreateComponent = /*#__PURE__*/(() => {\n  class VeterinarioCreateComponent {\n    constructor(formBuilder, toastr, veterinarioService, servicioService, agendaService, router) {\n      this.formBuilder = formBuilder;\n      this.toastr = toastr;\n      this.veterinarioService = veterinarioService;\n      this.servicioService = servicioService;\n      this.agendaService = agendaService;\n      this.router = router;\n      this.yar = false;\n      this.yac = false;\n    }\n    addRegistro(registro) {\n      this.idRegistro = registro;\n      this.yar = true;\n    }\n    addContacto(contacto) {\n      this.idContacto = contacto;\n      this.yac = true;\n      console.log(this.idContacto);\n    }\n    createVeterinario(newVeterinario) {\n      let lSstr = newVeterinario.serviciosOfrecidos.split(',');\n      let listServ = [];\n      for (let sstr of lSstr) {\n        let found = false;\n        for (let s of this.servicios) {\n          if (s.nombre == sstr) {\n            listServ.push(s);\n            found = true;\n            break;\n          }\n        }\n        if (!found) {\n          console.log(\"Servicio '\" + sstr + \"' no existe\");\n          return null;\n        }\n      }\n      console.log(listServ);\n      newVeterinario.calificacion = 0.0;\n      console.warn(\"el veterinario fue creado\", newVeterinario);\n      this.veterinarioService.createVeterinario(newVeterinario).subscribe(v => {\n        this.showSuccess(v);\n        //Se le asigna una agenda nueva al veterinario apenas se crea\n        let newAgenda = new Agenda(null, 0, 0, 0, []);\n        this.agendaService.createAgenda(newAgenda).subscribe(ag => {\n          this.toastr.success('Agenda creada exitosamente');\n          this.veterinarioService.createRegistroMedicoVeterinario(v.id, this.idRegistro).subscribe(rm => {\n            this.toastr.success('El registro médico ha sido asignado correctamente');\n          });\n          this.veterinarioService.createContactoVeterinario(v.id, this.idContacto).subscribe(co => {\n            this.toastr.success('El contacto ha sido asignado correctamente');\n          });\n          for (let s of listServ) {\n            this.veterinarioService.createServicioVeterinario(v.id, s.id).subscribe(s2 => {\n              this.toastr.success('El servicio fue creado correctamente');\n            });\n          }\n          this.agendaService.createAgendaVeterinario(ag.id, v.id).subscribe(ag2 => {\n            this.toastr.success('La agenda ha sido asignada correctamente');\n            this.router.navigate(['/veterinarios/' + v.id]);\n          });\n        });\n        this.veterinarioForm.reset();\n      });\n    }\n    showSuccess(v) {\n      this.toastr.success('Creado exitosamente!', 'Veterinario ${{v.nombre}}', {\n        \"progressBar\": true,\n        timeOut: 4000\n      });\n    }\n    cancelCreation() {\n      console.log(\"Cancelando ...\");\n      this.veterinarioForm.reset();\n    }\n    ngOnInit() {\n      this.veterinarioForm = this.formBuilder.group({\n        nombre: [\"\", [Validators.required, Validators.minLength(2)]],\n        especialidad: [\"\", Validators.required],\n        certificadoEntrenamiento: [\"\", Validators.required],\n        experienciaPrevia: [\"\", Validators.required],\n        serviciosOfrecidos: [\"\", Validators.required]\n      });\n      this.servicioService.getServicios().subscribe(servicios => {\n        this.servicios = servicios;\n      });\n    }\n    static #_ = this.ɵfac = function VeterinarioCreateComponent_Factory(t) {\n      return new (t || VeterinarioCreateComponent)(i0.ɵɵdirectiveInject(i1.UntypedFormBuilder), i0.ɵɵdirectiveInject(i2.ToastrService), i0.ɵɵdirectiveInject(i3.VeterinarioService), i0.ɵɵdirectiveInject(i4.ServicioService), i0.ɵɵdirectiveInject(i5.AgendaService), i0.ɵɵdirectiveInject(i6.Router));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: VeterinarioCreateComponent,\n      selectors: [[\"app-veterinario-create\"]],\n      decls: 51,\n      vars: 11,\n      consts: [[4, \"ngIf\"], [1, \"container-fluid\"], [1, \"col-4\", \"p-3\"], [1, \"h4\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\", \"mx-sm-3\", \"mb-2\"], [\"for\", \"nombre\"], [\"novalidate\", \"\", \"id\", \"nombre\", \"formControlName\", \"nombre\", \"placeholder\", \"Nombre Completo\", 1, \"form-control\"], [\"class\", \"alert alert-danger alert-dismissible fade show\", 4, \"ngIf\"], [\"for\", \"especialidad\"], [\"id\", \"especialidad\", \"type\", \"text\", \"formControlName\", \"especialidad\", \"placeholder\", \"Especialidad\", 1, \"form-control\"], [\"for\", \"certificadoEntrenamiento\"], [\"id\", \"certificadoEntrenamiento\", \"type\", \"text\", \"formControlName\", \"certificadoEntrenamiento\", \"placeholder\", \"Codigo del certificado de entrenamiento\", 1, \"form-control\"], [\"for\", \"experienciaPrevia\"], [\"id\", \"experienciaPrevia\", \"type\", \"text\", \"formControlName\", \"experienciaPrevia\", \"placeholder\", \"Experiencia Previa\", 1, \"form-control\"], [1, \"container\"], [4, \"ngFor\", \"ngForOf\"], [\"for\", \"serviciosOfrecidos\"], [\"id\", \"serviciosOfrecidos\", \"type\", \"text\", \"formControlName\", \"serviciosOfrecidos\", \"placeholder\", \"Servicios Ofrecidos separados por ','\", 1, \"form-control\"], [1, \"row\", \"m-3\", \"small\"], [1, \"row\", \"m-3\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", 3, \"disabled\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", \"ml-3\", 3, \"click\"], [3, \"newItemEvent\"], [1, \"alert\", \"alert-danger\", \"alert-dismissible\", \"fade\", \"show\"]],\n      template: function VeterinarioCreateComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵtemplate(0, VeterinarioCreateComponent_div_0_Template, 2, 0, \"div\", 0)(1, VeterinarioCreateComponent_div_1_Template, 2, 0, \"div\", 0);\n          i0.ɵɵelementStart(2, \"div\", 1)(3, \"div\", 2)(4, \"div\", 3);\n          i0.ɵɵtext(5, \"Creacion del Veterinario\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"form\", 4);\n          i0.ɵɵlistener(\"ngSubmit\", function VeterinarioCreateComponent_Template_form_ngSubmit_6_listener() {\n            return !ctx.veterinarioForm.invalid && ctx.createVeterinario(ctx.veterinarioForm.value);\n          });\n          i0.ɵɵelementStart(7, \"div\", 5)(8, \"label\", 6);\n          i0.ɵɵtext(9, \" Nombre* \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(10, \"input\", 7);\n          i0.ɵɵtemplate(11, VeterinarioCreateComponent_div_11_Template, 2, 0, \"div\", 8)(12, VeterinarioCreateComponent_div_12_Template, 2, 0, \"div\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"div\", 5)(14, \"label\", 9);\n          i0.ɵɵtext(15, \" Especialidad* \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(16, \"input\", 10);\n          i0.ɵɵtemplate(17, VeterinarioCreateComponent_div_17_Template, 2, 0, \"div\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(18, \"div\", 5)(19, \"label\", 11);\n          i0.ɵɵtext(20, \" Certificado de Entrenamieno* \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(21, \"input\", 12);\n          i0.ɵɵtemplate(22, VeterinarioCreateComponent_div_22_Template, 2, 0, \"div\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"div\", 5)(24, \"label\", 13);\n          i0.ɵɵtext(25, \" Experiencia Previa* \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(26, \"input\", 14);\n          i0.ɵɵtemplate(27, VeterinarioCreateComponent_div_27_Template, 2, 0, \"div\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(28, \"div\", 15)(29, \"table\")(30, \"thead\")(31, \"tr\")(32, \"th\");\n          i0.ɵɵtext(33, \"Servicios\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(34, \"tbody\");\n          i0.ɵɵtemplate(35, VeterinarioCreateComponent_tr_35_Template, 3, 1, \"tr\", 16);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(36, \"p\");\n          i0.ɵɵtext(37, \"De los servicios desplegados anteriormente, escriba los servicios que maneja separados por coma en el siguiente espacio\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(38, \"div\", 5)(39, \"label\", 17);\n          i0.ɵɵtext(40, \" Servicios Ofrecidos* \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(41, \"input\", 18);\n          i0.ɵɵtemplate(42, VeterinarioCreateComponent_div_42_Template, 2, 0, \"div\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(43, \"div\", 19)(44, \"p\");\n          i0.ɵɵtext(45, \"* Required fields\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(46, \"div\", 20)(47, \"button\", 21);\n          i0.ɵɵtext(48, \" Create \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(49, \"button\", 22);\n          i0.ɵɵlistener(\"click\", function VeterinarioCreateComponent_Template_button_click_49_listener() {\n            return ctx.cancelCreation();\n          });\n          i0.ɵɵtext(50, \" Cancel \");\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"ngIf\", !ctx.yar);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.yac);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"formGroup\", ctx.veterinarioForm);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.veterinarioForm.get(\"nombre\").hasError(\"required\") && ctx.veterinarioForm.get(\"nombre\").touched);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.veterinarioForm.get(\"nombre\").hasError(\"minlength\") && ctx.veterinarioForm.get(\"nombre\").touched);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.veterinarioForm.get(\"especialidad\").hasError(\"required\") && ctx.veterinarioForm.get(\"especialidad\").touched);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.veterinarioForm.get(\"certificadoEntrenamiento\").hasError(\"required\") && ctx.veterinarioForm.get(\"certificadoEntrenamiento\").touched);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.veterinarioForm.get(\"experienciaPrevia\").hasError(\"required\") && ctx.veterinarioForm.get(\"experienciaPrevia\").touched);\n          i0.ɵɵadvance(8);\n          i0.ɵɵproperty(\"ngForOf\", ctx.servicios);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"ngIf\", ctx.veterinarioForm.get(\"serviciosOfrecidos\").hasError(\"required\") && ctx.veterinarioForm.get(\"serviciosOfrecidos\").touched);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"disabled\", !ctx.veterinarioForm.valid);\n        }\n      },\n      dependencies: [i7.ContactoCreateComponent, i8.RegistroMedicoCreateComponent, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i9.NgForOf, i9.NgIf],\n      styles: [\"table[_ngcontent-%COMP%]{font-family:arial,sans-serif;border-collapse:collapse}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:.5px solid rgb(184,184,184);text-align:left;padding:8px}th[_ngcontent-%COMP%]{background-color:#e2e2e2}.bold[_ngcontent-%COMP%]{font-weight:700}\"]\n    });\n  }\n  return VeterinarioCreateComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}